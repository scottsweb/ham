alias: 'Telegram Media'
initial_state: true
hide_entity: true
trigger:
  - platform: event
    event_type: telegram_command
    event_data:
      command: '/media'
  - platform: event
    event_type: telegram_command
    event_data:
      command: '/media@columbo_bot'
action:
  - service: telegram_bot.send_message
    data_template:
      target: '{{ trigger.event.data.chat_id }}'
      disable_notification: true
      message: >
        {% if is_state('switch.tv', 'on') -%}
          The TV is on and {{ states('media_player.luther_universal_tv') }}:
          {%- if states.media_player.luther_universal_tv.attributes['media_title'] %} {{ states.media_player.luther_universal_tv.attributes['media_title'] }}{%- elif states.media_player.luther_universal_tv.attributes['source'] %} {{ states.media_player.luther_universal_tv.attributes['source'] }}{%- endif -%}
        {%- else -%}
          The TV is currently switched off.
        {%- endif %}
      inline_keyboard: 
        - 'TV On:/tv_on, TV Off:/tv_off'
        - 'Kodi:/kodi, Netflix:/netflix, Plex:/plex'
        - 'Cancel:/cancel'