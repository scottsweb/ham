alias: 'Telegram Energy'
initial_state: true
trigger:
  platform: event
  event_type: telegram_callback
  event_data:
    data: '/energy'
action:
  - service: telegram_bot.edit_replymarkup
    data_template:
      message_id: '{{ trigger.event.data.message.message_id }}'
      chat_id: '{{ trigger.event.data.chat_id }}'
      inline_keyboard: []
  - service: telegram_bot.send_message
    data_template:
      target: '{{ trigger.event.data.chat_id }}'
      callback_query_id: '{{ trigger.event.data.id }}'
      disable_notification: true
      message: >
        Current energy consumption is {{ states('sensor.emoncms104856_power_kw') }} watts and the meter is at: {{ states('sensor.emoncms104902_meter_count') }} kWh.


        The battery on the meter sensor is at {{ states('sensor.energybattery') }}%.
